<!doctype html><html class=dark lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1.0" name=viewport><title>Moving to Fedora: Automating PowerShell Installation with Ansible</title><meta content="Moving to Fedora: Automating PowerShell Installation with Ansible" property=og:title><meta content="Because repeating manual steps on multiple machines isn't fun anymore." property=og:description><meta content="Because repeating manual steps on multiple machines isn't fun anymore." name=description><link href=https://svnscha.de/posts/fedora-powershell-ansible/ rel=canonical><link href=/favicon.ico rel=icon type=image/png><link href=/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><link href=/favicon-32x32.png rel=icon sizes=32x32 type=image/png><link href=/favicon-16x16.png rel=icon sizes=16x16 type=image/png><link href=/site.webmanifest rel=manifest><link href=https://svnscha.de/fonts.css rel=stylesheet><script>var _paq=window._paq=window._paq||[];_paq.push(['disableCookies']);_paq.push(['trackPageView']);_paq.push(['enableLinkTracking']);_paq.push(['enableHeartBeatTimer']);(function(){var a="//analytics.liasoft.de/";_paq.push(['setTrackerUrl',a+ 'matomo.php']);_paq.push(['setSiteId','27']);var b=document,c=b.createElement('script'),d=b.getElementsByTagName('script')[0];c.async=true;c.src=a+ 'matomo.js';d.parentNode.insertBefore(c,d)})()</script><link href=https://svnscha.de/atom.xml rel=alternate title=svnscha type=application/atom+xml><link href=https://svnscha.de/theme/dark.css rel=stylesheet><link href=https://svnscha.de/main.css media=screen rel=stylesheet><link href=https://svnscha.de/lightbox.css rel=stylesheet><body><div class=content><header><style>.avatar{vertical-align:middle;width:150px;height:150px;border-radius:50%}#wrapper{width:100%;clear:both;text-align:center}</style><div class=main><a href=https://svnscha.de title=svnscha>svnscha</a><div class=socials><a class=social href=https://www.linkedin.com/in/svnscha/ rel=me> <img alt=linkedin src=/social_icons/linkedin.svg> </a><a class=social href=https://github.com/svnscha/ rel=me> <img alt=github src=/social_icons/github.svg> </a></div></div><nav><a href=/about style=margin-left:.7em>/about</a><a href=/notes style=margin-left:.7em>/notes</a></nav><div id=wrapper><a href=https://svnscha.de title=svnscha> <img alt="svnscha - Profile Picture" class=avatar src=/svnscha.webp> </a></div></header><main><article><div class=title><h1 class=page-header>Moving to Fedora: Automating PowerShell Installation with Ansible</h1><div class=meta>Posted on <time>2024-11-15</time></div></div><section class=body><h1 id=why-you-ask>Why, You Ask?</h1><p>So, you've moved to Fedora and find yourself needing PowerShell — whether it's for scripting, automation, or just that occasional <code>.ps1</code> nostalgia. But here's the thing: installing PowerShell manually on one machine is annoying enough. Doing it on several workstations, VMs, devcontainers, or servers? Nope, not happening.<p>This is where Ansible comes in. With one playbook, you can automate the entire installation process, saving time and making your setups consistent across all environments. Let's break it down.<h2 id=step-1-the-problem>Step 1: The Problem</h2><p>Installing PowerShell on Fedora involves downloading Microsoft's repository package, registering it, updating the package index, and then installing the actual PowerShell package. It's fine if you're doing it once, but if you have to repeat the process on multiple systems, it quickly becomes a chore.<p>The solution? Use Ansible to do it for you. Write the playbook once, and it works everywhere — no matter how many machines you're dealing with.<h2 id=step-2-the-playbook>Step 2: The Playbook</h2><p>Here's the Ansible playbook that automates PowerShell installation on Fedora:<pre class=language-yaml data-lang=yaml style=background:#282c34;color:#abb2bf><code class=language-yaml data-lang=yaml><span>---
</span><span>- </span><span style=color:#e06c75>name</span><span>: </span><span style=color:#98c379>Install PowerShell on Fedora 41 using Ansible
</span><span>  </span><span style=color:#e06c75>hosts</span><span>: </span><span style=color:#98c379>localhost
</span><span>  </span><span style=color:#e06c75>become</span><span>: </span><span style=color:#d19a66>yes
</span><span>  </span><span style=color:#e06c75>gather_facts</span><span>: </span><span style=color:#d19a66>true
</span><span>
</span><span>  </span><span style=color:#e06c75>tasks</span><span>:
</span><span>    - </span><span style=color:#e06c75>name</span><span>: </span><span style=color:#98c379>Download Microsoft repository package
</span><span>      </span><span style=color:#e06c75>ansible.builtin.get_url</span><span>:
</span><span>        </span><span style=color:#e06c75>url</span><span>: </span><span style=color:#98c379>https://packages.microsoft.com/config/rhel/8/packages-microsoft-prod.rpm
</span><span>        </span><span style=color:#e06c75>dest</span><span>: </span><span style=color:#98c379>/tmp/packages-microsoft-prod.rpm
</span><span>
</span><span>    - </span><span style=color:#e06c75>name</span><span>: </span><span style=color:#98c379>Register Microsoft repository
</span><span>      </span><span style=color:#e06c75>ansible.builtin.command</span><span>:
</span><span>        </span><span style=color:#e06c75>cmd</span><span>: </span><span style=color:#98c379>rpm -i /tmp/packages-microsoft-prod.rpm
</span><span>      </span><span style=color:#e06c75>args</span><span>:
</span><span>        </span><span style=color:#e06c75>creates</span><span>: </span><span style=color:#98c379>/etc/yum.repos.d/microsoft-prod.repo
</span><span>
</span><span>    - </span><span style=color:#e06c75>name</span><span>: </span><span style=color:#98c379>Remove repository package after registration
</span><span>      </span><span style=color:#e06c75>ansible.builtin.file</span><span>:
</span><span>        </span><span style=color:#e06c75>path</span><span>: </span><span style=color:#98c379>/tmp/packages-microsoft-prod.rpm
</span><span>        </span><span style=color:#e06c75>state</span><span>: </span><span style=color:#98c379>absent
</span><span>
</span><span>    - </span><span style=color:#e06c75>name</span><span>: </span><span style=color:#98c379>Update package index
</span><span>      </span><span style=color:#e06c75>ansible.builtin.dnf</span><span>:
</span><span>        </span><span style=color:#e06c75>update_cache</span><span>: </span><span style=color:#d19a66>yes
</span><span>        </span><span style=color:#e06c75>state</span><span>: </span><span style=color:#98c379>latest
</span><span>
</span><span>    - </span><span style=color:#e06c75>name</span><span>: </span><span style=color:#98c379>Install PowerShell
</span><span>      </span><span style=color:#e06c75>ansible.builtin.dnf</span><span>:
</span><span>        </span><span style=color:#e06c75>name</span><span>: </span><span style=color:#98c379>powershell
</span><span>        </span><span style=color:#e06c75>state</span><span>: </span><span style=color:#98c379>present
</span><span>
</span><span>    - </span><span style=color:#e06c75>name</span><span>: </span><span style=color:#98c379>Verify PowerShell installation
</span><span>      </span><span style=color:#e06c75>ansible.builtin.command</span><span>:
</span><span>        </span><span style=color:#e06c75>cmd</span><span>: </span><span style=color:#98c379>pwsh --version
</span><span>      </span><span style=color:#e06c75>register</span><span>: </span><span style=color:#98c379>pwsh_version_output
</span><span>
</span><span>    - </span><span style=color:#e06c75>name</span><span>: </span><span style=color:#98c379>Display PowerShell version
</span><span>      </span><span style=color:#e06c75>ansible.builtin.debug</span><span>:
</span><span>        </span><span style=color:#e06c75>msg</span><span>: </span><span style=color:#98c379>"Installed PowerShell version: {{ pwsh_version_output.stdout }}"
</span></code></pre><h2 id=step-3-usage>Step 3: Usage</h2><p>Running this playbook is straightforward. If you're working with a virtual environment for Ansible, make sure it's activated. Then, execute the playbook locally with the following command:<pre class=language-bash data-lang=bash style=background:#282c34;color:#abb2bf><code class=language-bash data-lang=bash><span style=color:#e06c75>ansible-playbook</span><span> /path/to/install-powershell.yml</span><span style=color:#e06c75> --connection</span><span>=local</span><span style=color:#e06c75> -K
</span></code></pre><p>Here's a quick breakdown:<ul><li><code>ansible-playbook</code>: Runs the playbook.<li><code>/path/to/install-powershell.yml</code>: Path to the playbook file.<li><code>--connection=local</code>: Executes the playbook on the local machine instead of a remote host.<li><code>-K</code>: Prompts for sudo privileges to perform the installation.</ul><p>With this command, you can easily install PowerShell on your Fedora system without worrying about missing steps.<h2 id=wrapping-up>Wrapping Up</h2><p>With this Ansible playbook, PowerShell installation on Fedora is no longer a manual, repetitive task. Whether you're setting up new workstations, provisioning servers, or managing devcontainers, this automation makes the process painless.<p>So, the next time you're staring down the prospect of yet another manual PowerShell install, let Ansible take care of it. Because honestly, you've got better things to do.</section></article></main><hr><center><small>Copyright © 2025 Sven Scharmentke. All rights reserved.</small></center></div><script src=https://svnscha.de/lightbox.js></script>