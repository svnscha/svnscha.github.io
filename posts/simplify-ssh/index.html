<!doctype html><html class=dark lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1.0" name=viewport><title>Simplify SSH</title><meta content="Simplify SSH" property=og:title><meta content="How to stop typing your SSH Key passphrase every time. (because, let's be real, we're all a little lazy)" property=og:description><meta content="How to stop typing your SSH Key passphrase every time. (because, let's be real, we're all a little lazy)" name=description><link href=https://svnscha.de/posts/simplify-ssh/ rel=canonical><link href=/favicon.ico rel=icon type=image/png><link href=/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><link href=/favicon-32x32.png rel=icon sizes=32x32 type=image/png><link href=/favicon-16x16.png rel=icon sizes=16x16 type=image/png><link href=/site.webmanifest rel=manifest><link href=https://svnscha.de/fonts.css rel=stylesheet><script>var _paq=window._paq=window._paq||[];_paq.push(['disableCookies']);_paq.push(['trackPageView']);_paq.push(['enableLinkTracking']);_paq.push(['enableHeartBeatTimer']);(function(){var a="//analytics.liasoft.de/";_paq.push(['setTrackerUrl',a+ 'matomo.php']);_paq.push(['setSiteId','27']);var b=document,c=b.createElement('script'),d=b.getElementsByTagName('script')[0];c.async=true;c.src=a+ 'matomo.js';d.parentNode.insertBefore(c,d)})()</script><link href=https://svnscha.de/atom.xml rel=alternate title=svnscha type=application/atom+xml><link href=https://svnscha.de/theme/dark.css rel=stylesheet><link href=https://svnscha.de/main.css media=screen rel=stylesheet><link href=https://svnscha.de/lightbox.css rel=stylesheet><body><div class=content><header><style>.avatar{vertical-align:middle;width:150px;height:150px;border-radius:50%}#wrapper{width:100%;clear:both;text-align:center}</style><div class=main><a href=https://svnscha.de title=svnscha>svnscha</a><div class=socials><a class=social href=https://www.linkedin.com/in/svnscha/ rel=me> <img alt=linkedin src=/social_icons/linkedin.svg> </a><a class=social href=https://github.com/svnscha/ rel=me> <img alt=github src=/social_icons/github.svg> </a></div></div><nav><a href=/about style=margin-left:.7em>/about</a><a href=/notes style=margin-left:.7em>/notes</a></nav><div id=wrapper><a href=https://svnscha.de title=svnscha> <img alt="svnscha - Profile Picture" class=avatar src=/svnscha.webp> </a></div></header><main><article><div class=title><h1 class=page-header>Simplify SSH</h1><div class=meta>Posted on <time>2024-10-03</time></div></div><section class=body><h2 id=why-you-ask>Why, You Ask?</h2><p>Every time I needed to SSH into a server, I'd be met with the same tedious ritual: entering my key passphrase again and again. You know the drill — open the terminal, type in your command, and boom! Another reminder that you still haven't figured out how to make your SSH key work seamlessly. But why, you ask? Because apparently, I love to live dangerously on the edge of frustration.<p><strong>It's time-consuming and frustrating. I'm tired of it.</strong><h2 id=getting-started>Getting Started</h2><p>So, you've got your shiny new SSH key and every time you want to connect to a server, you're greeted with that ever-familiar password prompt. Sure, typing your SSH key passphrase every time is good for security, but, come on — who wants to do that? I mean, I don't know about you, but I've got enough passwords to remember without constantly dealing with this nonsense.<p>Let's save ourselves some time and effort by getting the SSH agent to remember our keys for us. That way, you can just run your commands like the seasoned developer you are without worrying about the whole "password entering" thing every single time.<h2 id=step-1-start-the-ssh-agent>Step 1: Start the SSH Agent</h2><p>First things first — let's get the SSH agent up and running. It's like your personal SSH butler, here to remember your key so you don't have to.<p>Open up your terminal and type:<pre class=language-bash data-lang=bash style=background:#282c34;color:#abb2bf><code class=language-bash data-lang=bash><span style=color:#56b6c2>eval </span><span>$(</span><span style=color:#e06c75>ssh-agent -s</span><span>)
</span></code></pre><p>Boom! Now the agent is running in the background, ready to hold your keys like the responsible little daemon it is.<h2 id=step-2-add-your-key-to-the-ssh-agent>Step 2: Add your key to the SSH Agent</h2><p>Now that the agent is up, let's give it your key. You only need to do this once per session, and the agent will keep it ready for you.<pre class=language-bash data-lang=bash style=background:#282c34;color:#abb2bf><code class=language-bash data-lang=bash><span style=color:#e06c75>ssh-add ~</span><span>/.ssh/your_key
</span></code></pre><p>Replace <code>your_key</code> with the actual name of your private key file (you know, the one you just painstakingly created). Now, enter your passphrase <em>just this one time</em> — I promise — and you're set for the rest of your terminal session. No more typing that passphrase again and again.<h2 id=step-3-configure-your-ssh-setup-to-be-even-lazier-i-mean-efficient>Step 3: Configure your SSH setup to be even lazier (I mean efficient)</h2><p>Okay, we've got the agent running and the key added, but we can take it one step further. Why not tell SSH exactly what key to use for which server, so you never have to worry about it picking the wrong one?<p>To do this, we're going to set up a <code>~/.ssh/config</code> file. If you don't have this file yet, don't worry — it's as easy as creating it:<pre class=language-bash data-lang=bash style=background:#282c34;color:#abb2bf><code class=language-bash data-lang=bash><span style=color:#e06c75>touch ~</span><span>/.ssh/config
</span></code></pre><p>Now, crack open that file with your favorite text editor and set things up like this:<pre class=language-bash data-lang=bash style=background:#282c34;color:#abb2bf><code class=language-bash data-lang=bash><span style=color:#e06c75>Host</span><span> your-server-alias
</span><span>    </span><span style=color:#e06c75>HostName</span><span> your.server.com
</span><span>    </span><span style=color:#e06c75>User</span><span> your-username
</span><span>    </span><span style=color:#e06c75>IdentityFile ~</span><span>/.ssh/your_key
</span><span>    </span><span style=color:#e06c75>IdentitiesOnly</span><span> yes
</span></code></pre><h3 id=breaking-it-down>Breaking it down</h3><ul><li><strong>Host</strong>: You can use any alias here that makes sense to you. This is what you'll type when you want to connect to this server.<li><strong>HostName</strong>: The actual domain or IP address of the server.<li><strong>User</strong>: Your username on that server — this is where the "no more user mismatch" magic happens.<li><strong>IdentityFile</strong>: The path to your SSH private key.<li><strong>IdentitiesOnly yes</strong>: Tells SSH to use <em>only</em> this key, rather than trying every key it can find in the agent (which is how you avoid that annoying "user mismatch" issue).</ul><h2 id=step-4-create-a-wrapper-script-for-ssh-agent-control>Step 4: Create a wrapper script for SSH Agent control</h2><p>Alright, you want control over when your SSH agent starts up — totally understandable! Instead of running the agent automatically on login (which might feel a bit <em>too</em> autonomous), we'll create a neat little wrapper script. You can trigger it whenever you feel like starting the agent and adding your SSH key for the session.<p>Here's how to set that up.<h3 id=create-the-wrapper-script>Create the wrapper script</h3><p>Let's create a script that starts the SSH agent, adds your key, and gives you control over when it runs. We'll call this script <code>init-ssh</code>, and we'll stick it somewhere like <code>/usr/local/bin</code> so it's available from anywhere in your terminal.<ol><li><p><strong>Create the script:</strong> Open your terminal and create the <code>init-ssh</code> script:</p> <pre class=language-bash data-lang=bash style=background:#282c34;color:#abb2bf><code class=language-bash data-lang=bash><span style=color:#e06c75>sudo</span><span> nano /usr/local/bin/init-ssh
</span></code></pre><li><p><strong>Add the script content:</strong> Paste the following content into the file:</p> <pre class=language-bash data-lang=bash style=background:#282c34;color:#abb2bf><code class=language-bash data-lang=bash><span style=font-style:italic;color:#5c6370>#!/bin/bash
</span><span>
</span><span style=font-style:italic;color:#5c6370># Start the SSH agent
</span><span style=color:#56b6c2>eval </span><span>$(</span><span style=color:#e06c75>ssh-agent -s</span><span>)
</span><span>
</span><span style=font-style:italic;color:#5c6370># Add the key to the agent
</span><span style=color:#e06c75>ssh-add ~</span><span>/.ssh/your_key
</span><span>
</span><span style=font-style:italic;color:#5c6370># Optional: Display agent status for peace of mind
</span><span style=color:#e06c75>ssh-add -l
</span></code></pre><li><p><strong>Make the script executable:</strong> Give the script executable permissions:</p> <pre class=language-bash data-lang=bash style=background:#282c34;color:#abb2bf><code class=language-bash data-lang=bash><span style=color:#e06c75>sudo</span><span> chmod +x /usr/local/bin/init-ssh
</span></code></pre></ol><h4 id=how-to-use-the-script>How to use the script</h4><p>Whenever you want to start your SSH agent for a session, just run:<pre class=language-bash data-lang=bash style=background:#282c34;color:#abb2bf><code class=language-bash data-lang=bash><span style=color:#56b6c2>.</span><span> init-ssh
</span></code></pre><p>This will start the agent, add your key, and show you a list of the keys currently loaded in the agent. You've got full control — start the agent when you want, stop it when you're done, and enjoy a password-free SSH experience for the duration of that session.<h3 id=optional-stopping-the-ssh-agent>Optional: Stopping the SSH Agent</h3><p>If you want to stop the SSH agent after you're done with it, you can either let it die when you close your terminal or manually kill it with:<pre class=language-bash data-lang=bash style=background:#282c34;color:#abb2bf><code class=language-bash data-lang=bash><span style=color:#56b6c2>eval </span><span>$(</span><span style=color:#e06c75>ssh-agent -k</span><span>)
</span></code></pre><p>That way, you get all the convenience of an SSH agent when you need it, without it running indefinitely in the background. You're now in complete control of your SSH setup, and you can keep things secure and efficient, exactly the way you like it.<p>Happy SSH'ing!</section></article></main><hr><center><small>Copyright © 2025 Sven Scharmentke. All rights reserved.</small></center></div><script src=https://svnscha.de/lightbox.js></script>